<?php/*    CoreManager, PHP Front End for ArcEmu, MaNGOS, and TrinityCore    Copyright (C) 2012-2013  CoreManager Project    This program is free software: you can redistribute it and/or modify    it under the terms of the GNU General Public License as published by    the Free Software Foundation, either version 3 of the License, or    (at your option) any later version.    This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.    You should have received a copy of the GNU General Public License    along with this program.  If not, see <http://www.gnu.org/licenses/>.*/// this lib is used by login to get the correct user name even if the// user entered a screen name insteadrequire_once "../configs/config.php";require_once "config_lib.php";require_once "global_lib.php";$sql["logon"] = new SQL;$sql["logon"]->connect($logon_db["addr"], $logon_db["user"], $logon_db["pass"], $logon_db["name"], $logon_db["encoding"]);$sql["mgr"] = new SQL;$sql["mgr"]->connect($corem_db["addr"], $corem_db["user"], $corem_db["pass"], $corem_db["name"], $corem_db["encoding"]);// we duplicate the core detection that header usually does// if $core is ZERO then we auto-detect based on the auth databaseif ( $core == 0 )  $core = detectcore();if ( isset($_REQUEST["username"]) ){  $user = strip_tags(trim($_REQUEST["username"]));  // Query database for the user name  $query = "SELECT Login FROM config_accounts WHERE (ScreenName='".$user."' OR Login='".$user."')";  $result = $sql["mgr"]->query($query);  $result = $sql["mgr"]->fetch_assoc($result);  $name = $result["Login"];  echo json_encode(array("result" => $name));  die;}die;?>